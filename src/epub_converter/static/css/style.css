:root {
    --bg-color: #000000;
    --text-color: #ffffff;
    --sidebar-bg: #1a1a1a;
    --sidebar-border: #333;
    --sidebar-text: #ccc;
    --sidebar-hover-bg: #333;
    --link-color: #00ffff;
    --link-visited: #00cccc;
    --topbar-bg: rgba(26, 26, 26, 0.8);
    --topbar-button-hover: #444;
    --separator-color: #444;
    --sidebar-width: 320px;
    --topbar-height: 48px;
}
html, body {
    margin: 0;
    padding: 0;
    background-color: var(--bg-color);
    color: var(--text-color);
    font-family: serif;
    line-height: 1.6;
    scroll-behavior: smooth;
}
#app-container {
    display: flex;
    height: 100vh;
    overflow: hidden;
    position: relative;
}
#sidebar-container {
    position: fixed;
    top: 0;
    left: 0; /* occupy layout slot but moved off-screen with transform */
    width: var(--sidebar-width);
    height: 100%;
    /* Raise the sidebar above the top toolbar so the TOC visually overlays it */
    z-index: 1300;
    /* Use transform for smoother, GPU-accelerated animation */
    transform: translateX(-100%);
    transition: transform 0.26s cubic-bezier(.2,.9,.2,1);
    will-change: transform;
    box-shadow: 5px 0 15px rgba(0,0,0,0.5);
}
#content-wrapper {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    height: 100vh;
    /* Keep content-wrapper free of transforms so fixed-position children
       (like the top toolbar/right-controls) remain fixed to the viewport.
       Transforms will be applied to #main-content instead. */
}
/* Make room for the fixed top toolbar so content isn't hidden underneath */
#content-wrapper {
    padding-top: var(--topbar-height);
}
#app-container.sidebar-open #sidebar-container {
    transform: translateX(0);
}

/* On desktop, shift the main reading area when the sidebar opens. We apply
   transforms to #main-content (not #content-wrapper) to avoid creating a
   containing block that would break position:fixed children. */
@media (min-width: 768px) {
    #app-container.sidebar-open #main-content {
        transform: translateX(calc(var(--sidebar-width) * 0.5));
    }
}
#main-content {
    overflow-y: auto;
    flex-grow: 1;
    padding: 1rem;
    box-sizing: border-box;
    -webkit-overflow-scrolling: touch; /* smooth touch scrolling on iOS */
    touch-action: pan-y;
    will-change: scroll-position, transform;
    /* Allow the main content to be transformed when the sidebar opens. */
    transition: transform 0.26s cubic-bezier(.2,.9,.2,1);
    will-change: transform;
}

.toc-view {
    overflow-y: auto;
}

/* Scrollbar Styles */

/* Hide main scrollbar for mobile and tablet */
@media (max-width: 768px) {
    #main-content::-webkit-scrollbar {
        display: none;
    }
    #main-content {
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
    }
}

/* Style scrollbar for desktop */
@media (min-width: 769px) {
    #main-content::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }

    #main-content::-webkit-scrollbar-track {
        background: transparent;
    }

    #main-content::-webkit-scrollbar-thumb {
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 4px;
    }

    #main-content::-webkit-scrollbar-thumb:hover {
        background-color: rgba(255, 255, 255, 0.4);
    }

    #main-content::-webkit-scrollbar-corner {
        background: transparent;
    }
}

/* TOC Scrollbar Styles (visible on all screen sizes) */
.toc-view::-webkit-scrollbar {
    width: 4px;
    height: 4px;
}

.toc-view::-webkit-scrollbar-track {
    background: transparent;
}

.toc-view::-webkit-scrollbar-thumb {
    background-color: rgba(255, 255, 255, 0.2);
    border-radius: 2px;
}

.toc-view::-webkit-scrollbar-thumb:hover {
    background-color: rgba(255, 255, 255, 0.4);
}

.toc-view::-webkit-scrollbar-corner {
    background: transparent;
}
.content-body {
    max-width: 48rem;
    margin: 0 auto;
}
a { color: var(--link-color); }
a:visited { color: var(--link-visited); }
hr.chapter-separator { margin: 3em 0; border: none; border-top: 1px solid var(--separator-color); }
img { max-width: 100%; height: auto; display: block; margin: 1em auto; }

@media (min-width: 1200px) {
    /*
      Make desktop content match an approximate "63% zoom" feel by using
      a viewport-relative width (63vw) while constraining it with sensible
      minimum and maximum values to avoid too-narrow or too-wide lines.
      clamp(min, preferred, max) ensures the content remains readable.
    */
    .content-body {
        max-width: clamp(48rem, 63vw, 72rem);
        margin: 0 auto;
    }
    /* Add extra left/right padding on desktop for breathing room */
    #main-content {
        padding-left: 4rem;
        padding-right: 4rem;
    }
}

@media (min-width: 1600px) {
    /* For ultra-wide screens, increase side padding while clamp still caps width */
    #main-content {
        padding-left: 6rem;
        padding-right: 6rem;
    }
}
/* UI Components from toc_and_topbar.js */
.toc-sidebar {
    width: 100%; height: 100%; background: var(--sidebar-bg);
    box-shadow: 0 0 0 1px var(--sidebar-border); display: flex; flex-direction: column;
    font-family: 'Roboto', sans-serif;
}
.toc-sidebar-header {
    display: flex; align-items: center; padding: 1rem; border-bottom: 1px solid var(--sidebar-border);
}
.toc-sidebar-header img { width: 80px; height: 80px; border-radius: 3px; margin-right: 0.75rem; object-fit: cover; }
.toc-sidebar-header h1 { font-size: 1.1em; margin: 0; color: var(--text-color); font-family: 'Roboto', sans-serif; }
.toc-sidebar-header p { font-size: small; color: var(--sidebar-text); margin-top: 0.2rem; font-family: 'Roboto', sans-serif; }
.toc-view { padding: .5rem; overflow-y: auto; flex-grow: 1; }
.toc-view ul { list-style: none; padding: 0; margin: 0; }
.toc-view a, .toc-view span {
    display: block; padding: 8px 12px; text-decoration: none; color: var(--sidebar-text);
    border-radius: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    font-family: 'Roboto', sans-serif;
}
.toc-view a:hover { background: var(--sidebar-hover-bg); }
.toc-view ul ul { padding-left: 1rem; }
.top-toolbar {
    /* Fixed toolbar so its right-side controls remain visible while the
       content-wrapper and main content can be translated underneath. */
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    display: flex; justify-content: space-between; align-items: center; height: 48px;
    padding: 0 10px; background: var(--topbar-bg); backdrop-filter: blur(8px);
    border-bottom: 1px solid var(--sidebar-border); flex-shrink: 0;
    transition: opacity 0.22s ease, visibility 0.22s ease, transform 0.22s ease;
    will-change: opacity, transform;
    transform: translateZ(0);
    z-index: 1100; /* sit above the sidebar (1000) but below control buttons if needed */
}
/* The toolbar is fixed to the top and also acts as a positioned container
    for its absolutely-positioned inner controls. */
/* .top-toolbar remains position: fixed (declared above) so we do not
    re-declare position here which would break the fixed behavior. */

/* Keep the left controls visually fixed in the viewport so they don't move
   when the TOC opens. The right controls remain inside the toolbar and will
   slide together with the content-wrapper. */
.top-toolbar .top-left-controls {
    /* Left controls are absolutely positioned inside the fixed toolbar.
       When the sidebar opens we translate them to the right so they visually
       move with the content even though the toolbar itself is fixed. */
    position: absolute;
    left: 12px;
    top: calc((var(--topbar-height, 48px) - 40px) / 2);
    display: flex;
    gap: 6px;
    z-index: 1101; /* above the sidebar */
    transition: transform 0.26s cubic-bezier(.2,.9,.2,1);
    transform: translateX(0);
}

.top-toolbar .top-right-controls {
    /* Pin right controls to the viewport so they never slide off-screen when
       the TOC opens. Keep them above other UI with a higher z-index. */
    position: fixed;
    right: 12px;
    top: calc((var(--topbar-height, 48px) - 40px) / 2);
    display: flex;
    gap: 6px;
    z-index: 1200;
}
.top-toolbar.fullscreen-hidden {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
}
/* Fullscreen specific styles */
:fullscreen .top-toolbar {
    display: none !important;
}
:-webkit-full-screen .top-toolbar {
    display: none !important;
}
:-moz-full-screen .top-toolbar {
    display: none !important;
}
/* Adjust main content padding when top bar is hidden */
:fullscreen #main-content {
    padding-top: 0;
}
:-webkit-full-screen #main-content {
    padding-top: 0;
}
:-moz-full-screen #main-content {
    padding-top: 0;
}
.top-toolbar div { display: flex; align-items: center; }
.top-toolbar button {
    margin: 0 2px; padding: 10px; border: none; background: none; border-radius: 6px;
    cursor: pointer; color: var(--text-color); transition: background 0.2s;
    display: flex; align-items: center; justify-content: center;
}
.top-toolbar button:hover { background: var(--topbar-button-hover); }
.top-toolbar svg { width: 22px; height: 22px; }
/* Responsive Typography */
.text-xs { font-size: 0.75rem; }
.text-sm { font-size: 0.875rem; }
.text-base { font-size: 1rem; }
.text-lg { font-size: 1.125rem; }
.text-xl { font-size: 1.25rem; }
.text-2xl { font-size: 1.5rem; }
.text-3xl { font-size: 1.875rem; }
.text-4xl { font-size: 2.25rem; }
.text-5xl { font-size: 3rem; }

/* Responsive base font size */
@media (min-width: 768px) {
    /* Restore the previous content behavior: translate the content by half
       the sidebar width so the central reading area stays roughly centered.
       We'll additionally nudge the left controls so they end up fully
       visible (they'll move the remaining half-width). */
    #app-container.sidebar-open #main-content {
        transform: translateX(calc(var(--sidebar-width) * 0.5));
    }

    /* Position the left toolbar controls so they start where the TOC ends.
       Move them by the full sidebar width so they align to the right edge of
       the open sidebar (plus the left:12px offset defined earlier). */
    #app-container.sidebar-open .top-toolbar .top-left-controls {
        transform: translateX(var(--sidebar-width));
    }
}
@media (min-width: 769px) and (max-width: 1200px) {
    html {
        font-size: 16px;
    }
}

@media (min-width: 1201px) {
    html {
        font-size: 18px;
    }
}
